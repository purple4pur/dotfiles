set nocompatible

filetype plugin indent on
syntax on

set background=light
colorscheme PaperColor

let g:netrw_alto = 0
let g:netrw_keepdir = 0
let g:netrw_preview = 1
let g:netrw_winsize = 30

set autochdir
set autoread
set autowrite
set backspace=indent,eol,start
set clipboard+=unnamed
set complete-=i
set cursorline
set fileencodings=ucs-bom,utf-8,cp936 fileencoding=utf-8
set foldcolumn=0
set foldmethod=marker
set hidden
set hlsearch ignorecase smartcase incsearch
set listchars+=tab:>-,trail:~,extends:>,precedes:<
set mouse=a
set noerrorbells
set nofixendofline
set noshowmatch
set novisualbell
set number
set pastetoggle=<F5>
set scrolloff=1
set showcmd
set showtabline=2
set sidescroll=1
set sidescrolloff=3
set smartindent cindent autoindent
set smarttab shiftwidth=4 tabstop=4 softtabstop=4 expandtab
set splitbelow
set splitright
set t_Co=256
set t_ZH=[3m     " <C-V><ESC>[3m
set t_ZR=[23m    " <C-V><ESC>[23m
set tags+=../tags,../../tags
set textwidth=0
set virtualedit=block

" ********  gui configs  ********
if has("gui_running")
    if has("gui_win32")
        set guifont=æ›´çº±é»‘ä½“_Mono_SC_Nerd:h11
    endif
    set mousemodel=popup
endif

" ********  keymaps  ********
nnoremap ; :
vnoremap ; :
" movement
nnoremap j gj
nnoremap k gk
nnoremap 0 g0
nnoremap $ g$
nnoremap , ;
" edit
nnoremap < <<
nnoremap > >>
nnoremap <silent> <leader>2t :setlocal shiftwidth=2 tabstop=2 softtabstop=2 tabstop?<CR>
nnoremap <silent> <leader>3t :setlocal shiftwidth=3 tabstop=3 softtabstop=3 tabstop?<CR>
nnoremap <silent> <leader>4t :setlocal shiftwidth=4 tabstop=4 softtabstop=4 tabstop?<CR>
nnoremap <silent> <leader>8t :setlocal shiftwidth=8 tabstop=8 softtabstop=8 tabstop?<CR>
" search
nnoremap * *<C-O>
nnoremap # #<C-O>
nnoremap <silent> <leader>n :nohlsearch<CR>
" tab
inoremap <silent> <F3> <C-O>:tabprevious<CR>
inoremap <silent> <F4> <C-O>:tabnext<CR>
nnoremap <silent> <F3> :tabprevious<CR>
nnoremap <silent> <F4> :tabnext<CR>
nnoremap <silent> <leader><C-]> :tab tag <C-R><C-W><CR>
" window
nnoremap <silent> <C-H> <C-W>h
nnoremap <silent> <C-J> <C-W>j
nnoremap <silent> <C-K> <C-W>k
nnoremap <silent> <C-L> <C-W>l
autocmd FileType netrw call FixNetrwMap()
nnoremap <silent> <leader>, <C-W>10<
nnoremap <silent> <leader>. <C-W>10>
nnoremap <silent> <leader>- <C-W>5-
nnoremap <silent> <leader>= <C-W>5+
" fold
nnoremap <silent> <space> za
nnoremap <silent> <leader>f :call FoldColumnToggle()<CR>:set foldcolumn?<CR>
nnoremap <silent> <leader>mf :setlocal foldmethod=marker foldmethod?<CR>
nnoremap <silent> <leader>sf :setlocal foldmethod=syntax foldmethod?<CR>
" diff
nnoremap <leader>do :diffoff!<CR>
nnoremap <leader>dt :diffthis<CR>
nnoremap <leader>du :diffupdate!<CR>
" netrw
nnoremap <leader>e :Explore<CR>
nnoremap <leader>t :Texplore<CR>
nnoremap <leader>v :Vexplore!<CR>
" terminal
nnoremap <leader>T :tab terminal<CR>
tnoremap <C-\> <C-\><C-N>
" misc
nnoremap <silent> ZZ :echo "You've pressed ZZ!"<CR>
nnoremap <silent> <leader>l :setlocal list! list?<CR>
nnoremap <silent> <leader>w :setlocal wrap! wrap?<CR>
nnoremap <silent> <leader>z /\s\+$<CR>

" ********  map functions  ********
function FixNetrwMap()
    if hasmapto('<Plug>NetrwRefresh')
        unmap <buffer> <C-L>
        nnoremap <silent> <C-L> <C-W>l
    endif
endfunction

function FoldColumnToggle()
    if &foldcolumn
        setlocal foldcolumn=0
    else
        setlocal foldcolumn=2
    endif
endfunction


" ******************************************************
" ******************  status line  *********************
" modified from https://gist.github.com/suderman/1243665

" statusline setup
set laststatus=2
set statusline=%([%{&buflisted?bufnr('%'):''}]\ %)
set statusline+=%F\     " full filename

" display a warning if file encoding isnt utf-8
set statusline+=%#warningmsg#
set statusline+=%{(&fenc!='utf-8'&&&fenc!='')?'['.&fenc.']':''}
set statusline+=%*
set statusline+=%y      " filetype
set statusline+=%r      " read only flag
set statusline+=%m      " modified flag

" display a warning if &paste is set
set statusline+=%#error#
set statusline+=%{&paste?'[paste]':''}
set statusline+=%*
set statusline+=%=\     " left/right separator
set statusline+=%c,     " cursor column
set statusline+=%l/%L   " cursor line/total lines
set statusline+=\ %p%%  " percent through file
" ******************************************************